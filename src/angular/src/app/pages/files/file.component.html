<div class="file" [class.selected]="file().isSelected" #fileElement>
    <div class="content">
        <div class="status">
            @if (file().status === ViewFileStatus.DEFAULT && file().remoteSize > 0) {
                <img src="assets/icons/default-remote.svg" id="default-remote" />
            }
            @if (file().status === ViewFileStatus.QUEUED) {
                <img src="assets/icons/queued.svg" id="queued" />
            }
            @if (file().status === ViewFileStatus.DOWNLOADING) {
                <img src="assets/icons/downloading.svg" id="downloading" />
            }
            @if (file().status === ViewFileStatus.DOWNLOADED) {
                <img src="assets/icons/downloaded.svg" id="downloaded" />
            }
            @if (file().status === ViewFileStatus.STOPPED) {
                <img src="assets/icons/stopped.svg" id="stopped" />
            }
            @if (file().status === ViewFileStatus.DELETED) {
                <img src="assets/icons/deleted.svg" id="deleted" />
            }
            @if (file().status === ViewFileStatus.EXTRACTING) {
                <img src="assets/icons/extracting.svg" id="extracting" />
            }
            @if (file().status === ViewFileStatus.EXTRACTED) {
                <img src="assets/icons/extracted.svg" id="extracted" />
            }
            <!-- don't show text for default status -->
            @if (file().status !== ViewFileStatus.DEFAULT) {
                <span class="text">{{file().status | capitalize}}</span>
            }
        </div>
        <div class="name">
            @if (!file().isDir && !file().isArchive) {
                <img src="assets/icons/file-light.svg" />
            }
            @if (!file().isDir && file().isArchive) {
                <img src="assets/icons/file-archive-light.svg" />
            }
            @if (file().isDir && !file().isArchive) {
                <img src="assets/icons/directory-light.svg" />
            }
            @if (file().isDir && file().isArchive) {
                <img src="assets/icons/directory-archive-light.svg" />
            }
            <div class="text">
                <div class="title">
                    {{file().name}}
                </div>
                @if ((options() | async)?.showDetails) {
                    <div class="details">
                        <div class="details-text">
                            Remote File<br />
                            <span class="tab"></span>Created:
                                {{(file().remoteCreatedTimestamp | date: 'EEE, MMM d yyyy, h:mm:ss a') ||
                                   "Not Available"}}<br />
                            <span class="tab"></span>Modified:
                                {{(file().remoteModifiedTimestamp | date: 'EEE, MMM d yyyy, h:mm:ss a') ||
                                   "Not Available"}}<br />
                            Local File <br />
                            <span class="tab"></span>Created:
                                {{(file().localCreatedTimestamp | date: 'EEE, MMM d yyyy, h:mm:ss a') ||
                                   "Not Available"}}<br />
                            <span class="tab"></span>Modified:
                                {{(file().localModifiedTimestamp | date: 'EEE, MMM d yyyy, h:mm:ss a') ||
                                   "Not Available"}}
                        </div>
                    </div>
                }
            </div>
        </div>
        <div class="speed">
            @if (file().downloadingSpeed) {
                <span>{{file().downloadingSpeed | fileSize:3}}/s</span>
            }
            <!-- for mobile layout -->
            <div class="speed-eta">
                @if (file().status === ViewFileStatus.DOWNLOADING) {
                    <span>eta: {{file().eta | eta}}</span>
                }
            </div>
        </div>
        <!-- for desktop layout -->
        <div class="eta">
            @if (file().status === ViewFileStatus.DOWNLOADING) {
                <span>{{file().eta | eta}}</span>
            }
        </div>
        <div class="size">
            <div class="progress">
                <div class="progress-bar" role="progressbar"
                     [class.progress-bar-animated]="
                        file().status === ViewFileStatus.DOWNLOADING ||
                        file().status === ViewFileStatus.EXTRACTING
                     "
                     [class.progress-bar-striped]="
                        file().status === ViewFileStatus.DOWNLOADING ||
                        file().status === ViewFileStatus.EXTRACTING
                     "
                     [attr.aria-valuenow]="file().percentDownloaded" aria-valuemin="0" aria-valuemax="100"
                     [style.width]="
                        min(file().percentDownloaded,100) + '%'
                     ">
                    {{file().percentDownloaded}}%
                </div>
            </div>
            <div class="size_info">
                {{file().localSize | fileSize:3}} of {{file().remoteSize | fileSize:3}}
            </div>
        </div>
    </div>

    <!-- actions div, visible on selection -->
    <div class="actions">
        <div class="button" appClickStopPropagation
             [attr.disabled]="isQueueable() ? null : true"
             (click)="!isQueueable() || onQueue(file())"
             [class.loading]="activeAction === FileAction.QUEUE">
            <div class="loader"></div>
            <img src="assets/icons/queue.svg" />
            <div class="text"><span>Queue</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isStoppable() ? null : true"
             (click)="!isStoppable() || onStop(file())"
             [class.loading]="activeAction === FileAction.STOP">
            <div class="loader"></div>
            <img src="assets/icons/stop.svg" />
            <div class="text"><span>Stop</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isExtractable() ? null : true"
             (click)="!isExtractable() || onExtract(file())"
             [class.loading]="activeAction === FileAction.EXTRACT">
            <div class="loader"></div>
            <img src="assets/icons/extract.svg" />
            <div class="text"><span>Extract</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isLocallyDeletable() ? null : true"
             (click)="!isLocallyDeletable() || onDeleteLocal(file())"
             [class.loading]="activeAction === FileAction.DELETE_LOCAL">
            <div class="loader"></div>
            <img src="assets/icons/delete-local.svg" />
            <div class="text"><span>Delete Local</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isRemotelyDeletable() ? null : true"
             (click)="!isRemotelyDeletable() || onDeleteRemote(file())"
             [class.loading]="activeAction === FileAction.DELETE_REMOTE">
            <div class="loader"></div>
            <img src="assets/icons/delete-remote.svg" />
            <div class="text"><span>Delete Remote</span></div>
        </div>
    </div>

    <!-- Delete confirmation dialog -->
    @if (deleteConfirmationType) {
        <div class="delete-confirmation" appClickStopPropagation>
            <div class="confirmation-content">
                <div class="confirmation-title">{{deleteConfirmationTitle}}</div>
                <div class="confirmation-message" [innerHTML]="deleteConfirmationMessage"></div>
                <div class="confirmation-buttons">
                    <button class="btn btn-secondary" (click)="cancelDelete()">Cancel</button>
                    <button class="btn btn-danger" (click)="confirmDelete()">Delete</button>
                </div>
            </div>
        </div>
    }
</div>
